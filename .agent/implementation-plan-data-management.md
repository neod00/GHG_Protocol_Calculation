# ğŸ“‹ GHG Calculator - ë°ì´í„° ê´€ë¦¬ ê¸°ëŠ¥ ê°œì„  êµ¬í˜„ ê³„íšì„œ

> **ì‘ì„±ì¼**: 2025-12-28  
> **ìƒíƒœ**: ê³„íš ë‹¨ê³„ (ìŠ¹ì¸ ëŒ€ê¸°)

---

## ğŸ“Œ ê°œìš”

ì‚¬ìš©ì ë°ì´í„° ê´€ë¦¬ ê²½í—˜ì„ ê°œì„ í•˜ê¸° ìœ„í•œ 7ê°€ì§€ í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„ ê³„íšì…ë‹ˆë‹¤.

### êµ¬í˜„ ê¸°ëŠ¥ ëª©ë¡

| # | ê¸°ëŠ¥ | ìš°ì„ ìˆœìœ„ | ì˜ˆìƒ ë‚œì´ë„ |
|---|------|---------|------------|
| 1 | ìë™ì €ì¥ (ë¡œê·¸ì¸ ì‚¬ìš©ì) | ğŸ”´ High | â­â­ |
| 2 | ë²„íŠ¼ ë¼ë²¨ ë³€ê²½ | ğŸ”´ High | â­ |
| 3 | ì—‘ì…€ ë‹¤ìš´ë¡œë“œ | ğŸ”´ High | â­â­ |
| 4 | ì €ì¥ ìƒíƒœ í‘œì‹œ (Auto-save Indicator) | ğŸŸ¡ Medium | â­â­ |
| 5 | ì—‘ì…€ ì—…ë¡œë“œ/í…œí”Œë¦¿ | ğŸŸ¡ Medium | â­â­â­ |
| 6 | í”„ë¡œì íŠ¸ ë²„ì „ ê´€ë¦¬ | ğŸŸ¡ Medium | â­â­â­â­ |
| 7 | í˜‘ì—… ê¸°ëŠ¥ (ê´€ë¦¬ì ìŠ¹ì¸ ë°©ì‹) | ğŸŸ¢ Low | â­â­â­â­ |

---

## ğŸ”§ Phase 1: í•µì‹¬ ì €ì¥ ê¸°ëŠ¥ (ì˜ˆìƒ ê¸°ê°„: 2-3ì¼)

### 1.1 ìë™ì €ì¥ (ë¡œê·¸ì¸ ì‚¬ìš©ì)

#### ğŸ“ ìš”êµ¬ì‚¬í•­
- ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ë°ì´í„° ë³€ê²½ ì‹œ Supabaseì— ìë™ ì €ì¥
- Debounce ì ìš© (2-3ì´ˆ ì§€ì—°)ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ë°©ì§€
- ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ìëŠ” ê¸°ì¡´ëŒ€ë¡œ localStorageì— ì €ì¥

#### ğŸ—ï¸ êµ¬í˜„ ê³„íš

**íŒŒì¼ ìˆ˜ì •:**
- `src/components/MainCalculator.tsx`

**êµ¬í˜„ ë‚´ìš©:**
```typescript
// 1. debounce í›… ë˜ëŠ” ìœ í‹¸ë¦¬í‹° ì¶”ê°€
const useDebouncedAutoSave = (data, delay = 2000) => {
  // debounce ë¡œì§
};

// 2. ë°ì´í„° ë³€ê²½ ê°ì§€ ë° ìë™ ì €ì¥
useEffect(() => {
  if (!isAuthenticated || !projectId) return;
  
  const saveData = async () => {
    setSaveStatus('saving');
    try {
      await saveProjectData(projectId, allSources, facilities);
      setSaveStatus('saved');
    } catch (error) {
      setSaveStatus('error');
    }
  };
  
  const timeoutId = setTimeout(saveData, 2000);
  return () => clearTimeout(timeoutId);
}, [sources, facilities, allFactors]);
```

**ìƒˆë¡œìš´ ìƒíƒœ ì¶”ê°€:**
```typescript
type SaveStatus = 'idle' | 'saving' | 'saved' | 'error';
const [saveStatus, setSaveStatus] = useState<SaveStatus>('idle');
const [lastSavedAt, setLastSavedAt] = useState<Date | null>(null);
```

---

### 1.2 ë²„íŠ¼ ë¼ë²¨ ë³€ê²½

#### ğŸ“ ìš”êµ¬ì‚¬í•­
- "í´ë¼ìš°ë“œì— ì €ì¥" â†’ "ë‚´ í”„ë¡œì íŠ¸ ì €ì¥" ìœ¼ë¡œ ë³€ê²½
- ë‹¤êµ­ì–´ ì§€ì› (í•œ/ì˜)

#### ğŸ—ï¸ êµ¬í˜„ ê³„íš

**íŒŒì¼ ìˆ˜ì •:**
- `src/translations/main.ts`
- `src/components/MainCalculator.tsx`

**ë²ˆì—­ í‚¤ ë³€ê²½:**
```typescript
// main.ts - Korean
saveToCloud: 'í´ë¼ìš°ë“œì— ì €ì¥',  // ê¸°ì¡´
saveProject: 'ë‚´ í”„ë¡œì íŠ¸ ì €ì¥', // ë³€ê²½

// main.ts - English
saveToCloud: 'Save to Cloud',    // ê¸°ì¡´
saveProject: 'Save My Project',  // ë³€ê²½
```

**UI ë³€ê²½:**
- ë²„íŠ¼ ì•„ì´ì½˜ë„ â˜ï¸ â†’ ğŸ’¾ ë˜ëŠ” ğŸ“ë¡œ ë³€ê²½ ê³ ë ¤

---

### 1.3 ì—‘ì…€ ë‹¤ìš´ë¡œë“œ

#### ğŸ“ ìš”êµ¬ì‚¬í•­
- ëª¨ë“  ë°°ì¶œì› ë°ì´í„°ë¥¼ Excel íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ
- ì‹œì„¤ë³„, Scopeë³„ ì‹œíŠ¸ êµ¬ë¶„
- íŒŒì¼ëª…: `{íšŒì‚¬ëª…}_{ë³´ê³ ì—°ë„}_GHG_Data.xlsx`

#### ğŸ—ï¸ êµ¬í˜„ ê³„íš

**íŒ¨í‚¤ì§€ ì„¤ì¹˜:**
```bash
npm install xlsx
```

**ìƒˆ íŒŒì¼ ìƒì„±:**
- `src/utils/excelExport.ts`
- `src/components/ExportButton.tsx`

**ì—‘ì…€ êµ¬ì¡°:**
```
ğŸ“Š GHG_Emissions_2025.xlsx
â”œâ”€â”€ Sheet 1: Summary (ìš”ì•½)
â”‚   â”œâ”€â”€ íšŒì‚¬ëª…, ë³´ê³ ì—°ë„
â”‚   â”œâ”€â”€ Scope 1 ì´ ë°°ì¶œëŸ‰
â”‚   â”œâ”€â”€ Scope 2 ì´ ë°°ì¶œëŸ‰ (Location/Market)
â”‚   â””â”€â”€ Scope 3 ì´ ë°°ì¶œëŸ‰
â”‚
â”œâ”€â”€ Sheet 2: Scope 1 Details
â”‚   â”œâ”€â”€ ì‹œì„¤ëª… | ì¹´í…Œê³ ë¦¬ | ì—°ë£Œíƒ€ì… | ì›”ë³„ ì‚¬ìš©ëŸ‰ | ë°°ì¶œëŸ‰
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ Sheet 3: Scope 2 Details
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ Sheet 4: Scope 3 Details
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ Sheet 5: Emission Factors
    â””â”€â”€ ì‚¬ìš©ëœ ë°°ì¶œê³„ìˆ˜ ëª©ë¡
```

**êµ¬í˜„ ì½”ë“œ ì˜ˆì‹œ:**
```typescript
// excelExport.ts
import * as XLSX from 'xlsx';

export const exportToExcel = (data: ExportData) => {
  const workbook = XLSX.utils.book_new();
  
  // Summary Sheet
  const summarySheet = XLSX.utils.json_to_sheet([
    { í•­ëª©: 'íšŒì‚¬ëª…', ê°’: data.companyName },
    { í•­ëª©: 'ë³´ê³ ì—°ë„', ê°’: data.reportingYear },
    { í•­ëª©: 'Scope 1 ë°°ì¶œëŸ‰', ê°’: data.scope1Total },
    // ...
  ]);
  XLSX.utils.book_append_sheet(workbook, summarySheet, 'Summary');
  
  // Scope 1 Details...
  // Scope 2 Details...
  // Scope 3 Details...
  
  // Download
  XLSX.writeFile(workbook, `${data.companyName}_${data.reportingYear}_GHG_Data.xlsx`);
};
```

---

## ğŸ”§ Phase 2: UX ê°œì„  (ì˜ˆìƒ ê¸°ê°„: 2-3ì¼)

### 2.1 ì €ì¥ ìƒíƒœ í‘œì‹œ (Auto-save Indicator)

#### ğŸ“ ìš”êµ¬ì‚¬í•­
- ìƒë‹¨ í—¤ë” ë˜ëŠ” í™”ë©´ ìš°ì¸¡ì— ì €ì¥ ìƒíƒœ í‘œì‹œ
- ìƒíƒœ: ì €ì¥ ì™„ë£Œ / ì €ì¥ ì¤‘ / ì €ì¥ ì‹¤íŒ¨ / ì˜¤í”„ë¼ì¸

#### ğŸ—ï¸ êµ¬í˜„ ê³„íš

**ìƒˆ íŒŒì¼ ìƒì„±:**
- `src/components/SaveStatusIndicator.tsx`

**UI ë””ìì¸:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… ì €ì¥ë¨ Â· 19:55                                       â”‚  ë…¹ìƒ‰, ì²´í¬ ì•„ì´ì½˜
â”‚  ğŸ”„ ì €ì¥ ì¤‘...                                           â”‚  íŒŒë‘, íšŒì „ ì•„ì´ì½˜
â”‚  âš ï¸ ì €ì¥ ì‹¤íŒ¨ Â· ì¬ì‹œë„                                   â”‚  ë¹¨ê°•, ê²½ê³  ì•„ì´ì½˜
â”‚  ğŸ“´ ì˜¤í”„ë¼ì¸ Â· ì—°ê²° ì‹œ ìë™ ì €ì¥                          â”‚   íšŒìƒ‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì»´í¬ë„ŒíŠ¸ ì½”ë“œ:**
```tsx
// SaveStatusIndicator.tsx
interface Props {
  status: 'idle' | 'saving' | 'saved' | 'error' | 'offline';
  lastSavedAt?: Date;
  onRetry?: () => void;
}

export const SaveStatusIndicator: React.FC<Props> = ({ status, lastSavedAt, onRetry }) => {
  const statusConfig = {
    idle: { icon: 'â—‹', text: '', className: 'text-gray-400' },
    saving: { icon: 'ğŸ”„', text: 'ì €ì¥ ì¤‘...', className: 'text-blue-500 animate-spin' },
    saved: { icon: 'âœ…', text: `ì €ì¥ë¨ Â· ${formatTime(lastSavedAt)}`, className: 'text-green-500' },
    error: { icon: 'âš ï¸', text: 'ì €ì¥ ì‹¤íŒ¨', className: 'text-red-500', action: 'ì¬ì‹œë„' },
    offline: { icon: 'ğŸ“´', text: 'ì˜¤í”„ë¼ì¸', className: 'text-gray-500' },
  };
  
  // ... render
};
```

**ë°°ì¹˜ ìœ„ì¹˜:**
- `Header.tsx` ìš°ì¸¡ ë˜ëŠ”
- `MainCalculator.tsx` ìƒë‹¨ ì €ì¥ ë²„íŠ¼ ì˜†

---

### 2.2 ì—‘ì…€ ì—…ë¡œë“œ/í…œí”Œë¦¿

#### ğŸ“ ìš”êµ¬ì‚¬í•­
- ë°ì´í„° ì…ë ¥ìš© ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
- ì‘ì„±ëœ ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œí•˜ì—¬ ë°ì´í„° ì¼ê´„ ì…ë ¥
- ì—…ë¡œë“œ ì‹œ ë°ì´í„° ê²€ì¦ ë° ì˜¤ë¥˜ í‘œì‹œ

#### ğŸ—ï¸ êµ¬í˜„ ê³„íš

**ìƒˆ íŒŒì¼ ìƒì„±:**
- `src/utils/excelImport.ts`
- `src/components/ExcelUploadModal.tsx`
- `public/templates/GHG_Input_Template.xlsx`

**í…œí”Œë¦¿ êµ¬ì¡°:**
```
ğŸ“„ GHG_Input_Template.xlsx
â”œâ”€â”€ Sheet 1: Instructions (ì‚¬ìš© ì•ˆë‚´)
â”‚   â””â”€â”€ ì‘ì„± ë°©ë²•, í•„ë“œ ì„¤ëª…
â”‚
â”œâ”€â”€ Sheet 2: Facilities (ì‹œì„¤ ì •ë³´)
â”‚   â””â”€â”€ ì‹œì„¤ID | ì‹œì„¤ëª… | ì§€ë¶„ìœ¨
â”‚
â”œâ”€â”€ Sheet 3: Scope1_StationaryCombustion
â”‚   â””â”€â”€ ì‹œì„¤ID | ì—°ë£Œíƒ€ì… | ë‹¨ìœ„ | 1ì›” | 2ì›” | ... | 12ì›”
â”‚
â”œâ”€â”€ Sheet 4: Scope1_MobileCombustion
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ Sheet 5: Scope2_PurchasedEnergy
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ Sheet 6: Scope3_Categories
    â””â”€â”€ ì¹´í…Œê³ ë¦¬ | ì„¸ë¶€í•­ëª© | ...
```

**ì—…ë¡œë“œ í”Œë¡œìš°:**
```
1. ì‚¬ìš©ìê°€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
2. ì—‘ì…€ì—ì„œ ë°ì´í„° ì‘ì„±
3. "ì—‘ì…€ ì—…ë¡œë“œ" ë²„íŠ¼ í´ë¦­
4. íŒŒì¼ ì„ íƒ ë° ë¯¸ë¦¬ë³´ê¸°
5. ë°ì´í„° ê²€ì¦ (ì—ëŸ¬ í‘œì‹œ)
6. í™•ì¸ í›„ ë°ì´í„° ì ìš©
```

**ê²€ì¦ í•­ëª©:**
- í•„ìˆ˜ í•„ë“œ ëˆ„ë½ í™•ì¸
- ë°ì´í„° íƒ€ì… ê²€ì¦ (ìˆ«ì, ë‚ ì§œ ë“±)
- ìœ íš¨í•œ ì‹œì„¤ID, ì—°ë£Œíƒ€ì… ê²€ì¦
- ì¤‘ë³µ ë°ì´í„° ê°ì§€

---

## ğŸ”§ Phase 3: ê³ ê¸‰ ê¸°ëŠ¥ (ì˜ˆìƒ ê¸°ê°„: 4-5ì¼)

### 3.1 í”„ë¡œì íŠ¸ ë²„ì „ ê´€ë¦¬ (Version History)

#### ğŸ“ ìš”êµ¬ì‚¬í•­
- í”„ë¡œì íŠ¸ ì €ì¥ ì‹œ ë²„ì „ ìë™ ìƒì„±
- ì´ì „ ë²„ì „ ëª©ë¡ ì¡°íšŒ ë° ë³µì› ê¸°ëŠ¥
- ë²„ì „ë³„ ë³€ê²½ ë‚´ìš© ë¹„êµ (ì„ íƒì )

#### ğŸ—ï¸ êµ¬í˜„ ê³„íš

**ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì¶”ê°€:**
```sql
-- ìƒˆ í…Œì´ë¸”: project_versions
CREATE TABLE project_versions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
  version_number INTEGER NOT NULL,
  snapshot_data JSONB NOT NULL,  -- ì „ì²´ í”„ë¡œì íŠ¸ ë°ì´í„° ìŠ¤ëƒ…ìƒ·
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  created_by UUID REFERENCES auth.users(id),
  note TEXT,  -- ë²„ì „ ë©”ëª¨ (ì„ íƒ)
  
  UNIQUE(project_id, version_number)
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_project_versions_project ON project_versions(project_id);
CREATE INDEX idx_project_versions_created ON project_versions(created_at DESC);
```

**ìƒˆ íŒŒì¼ ìƒì„±:**
- `src/app/actions/versions.ts`
- `src/components/VersionHistoryModal.tsx`

**Server Actions:**
```typescript
// versions.ts
export async function createVersion(projectId: string, note?: string) {
  // í˜„ì¬ í”„ë¡œì íŠ¸ ë°ì´í„°ë¥¼ ìŠ¤ëƒ…ìƒ·ìœ¼ë¡œ ì €ì¥
}

export async function getVersionHistory(projectId: string) {
  // ë²„ì „ ëª©ë¡ ì¡°íšŒ
}

export async function restoreVersion(projectId: string, versionId: string) {
  // íŠ¹ì • ë²„ì „ìœ¼ë¡œ ë³µì›
}
```

**UI ë””ìì¸:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“œ ë²„ì „ ê¸°ë¡                                          [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â— v5 (í˜„ì¬)  Â·  ì˜¤ëŠ˜ 19:55  Â·  ê¹€ì² ìˆ˜                      â”‚
â”‚    â”” "Scope 3 ë°ì´í„° ì¶”ê°€"                                  â”‚
â”‚                                                             â”‚
â”‚  â—‹ v4  Â·  ì˜¤ëŠ˜ 15:30  Â·  ê¹€ì² ìˆ˜              [ë³µì›] [ë¹„êµ]  â”‚
â”‚    â”” "ì‹œì„¤ ì •ë³´ ìˆ˜ì •"                                       â”‚
â”‚                                                             â”‚
â”‚  â—‹ v3  Â·  ì–´ì œ 10:00  Â·  ê¹€ì² ìˆ˜              [ë³µì›] [ë¹„êµ]  â”‚
â”‚    â”” ìë™ ì €ì¥                                              â”‚
â”‚                                                             â”‚
â”‚  â—‹ v2  Â·  2025-12-26  Â·  ê¹€ì² ìˆ˜              [ë³µì›] [ë¹„êµ]  â”‚
â”‚                                                             â”‚
â”‚  â—‹ v1  Â·  2025-12-25  Â·  ê¹€ì² ìˆ˜              [ë³µì›] [ë¹„êµ]  â”‚
â”‚    â”” "ì´ˆê¸° ì„¤ì •"                                            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë²„ì „ ìƒì„± ì •ì±…:**
- ìë™ ìƒì„±: ì¤‘ìš”í•œ ë³€ê²½ ì‹œ (ì„¤ì • ë³€ê²½, ëŒ€ëŸ‰ ë°ì´í„° ì¶”ê°€ ë“±)
- ìˆ˜ë™ ìƒì„±: "ë²„ì „ ì €ì¥" ë²„íŠ¼ìœ¼ë¡œ ë©”ëª¨ì™€ í•¨ê»˜ ì €ì¥
- ë³´ê´€ ì •ì±…: ìµœì‹  20ê°œ ë²„ì „ ìœ ì§€ (ë˜ëŠ” êµ¬ë… í‹°ì–´ë³„ ì°¨ë“±)

---

### 3.2 í˜‘ì—… ê¸°ëŠ¥ (ê´€ë¦¬ì ìŠ¹ì¸ ë°©ì‹)

#### ğŸ“ ìš”êµ¬ì‚¬í•­
- í”„ë¡œì íŠ¸ ê³µìœ  ìš”ì²­ ê¸°ëŠ¥ (ì‚¬ìš©ì â†’ ê´€ë¦¬ì)
- ê´€ë¦¬ì ìŠ¹ì¸ í›„ í˜‘ì—… í™œì„±í™”
- ì—­í• : ì†Œìœ ì / í¸ì§‘ì / ì—´ëŒì

#### ğŸ—ï¸ êµ¬í˜„ ê³„íš

**ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì¶”ê°€:**
```sql
-- í”„ë¡œì íŠ¸ ë©¤ë²„ í…Œì´ë¸”
CREATE TABLE project_members (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  role TEXT NOT NULL CHECK (role IN ('owner', 'editor', 'viewer')),
  invited_by UUID REFERENCES auth.users(id),
  invited_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  accepted_at TIMESTAMP WITH TIME ZONE,
  
  UNIQUE(project_id, user_id)
);

-- í˜‘ì—… ìš”ì²­ í…Œì´ë¸”
CREATE TABLE collaboration_requests (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
  requester_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  target_email TEXT NOT NULL,  -- ì´ˆëŒ€í•  ì‚¬ìš©ì ì´ë©”ì¼
  requested_role TEXT NOT NULL CHECK (requested_role IN ('editor', 'viewer')),
  status TEXT NOT NULL DEFAULT 'pending' CHECK (status IN ('pending', 'approved', 'rejected')),
  admin_note TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  processed_at TIMESTAMP WITH TIME ZONE,
  processed_by UUID REFERENCES auth.users(id)
);
```

**ìƒˆ íŒŒì¼ ìƒì„±:**
- `src/app/actions/collaboration.ts`
- `src/components/CollaborationModal.tsx`
- `src/components/admin/CollaborationRequestsPanel.tsx`

**ì›Œí¬í”Œë¡œìš°:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í˜‘ì—… ìš”ì²­ í”Œë¡œìš°                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1ï¸âƒ£  ì‚¬ìš©ì A (í”„ë¡œì íŠ¸ ì†Œìœ ì)                              â”‚
â”‚      â†“                                                      â”‚
â”‚      "íŒ€ì› ì´ˆëŒ€" ë²„íŠ¼ í´ë¦­                                   â”‚
â”‚      â†“                                                      â”‚
â”‚  2ï¸âƒ£  ì´ˆëŒ€í•  ì´ë©”ì¼ + ì—­í•  ì„ íƒ                               â”‚
â”‚      â†“                                                      â”‚
â”‚  3ï¸âƒ£  í˜‘ì—… ìš”ì²­ ìƒì„± (pending ìƒíƒœ)                          â”‚
â”‚      â†“                                                      â”‚
â”‚  4ï¸âƒ£  ê´€ë¦¬ìì—ê²Œ ì•Œë¦¼ (Admin Dashboard)                      â”‚
â”‚      â†“                                                      â”‚
â”‚  5ï¸âƒ£  ê´€ë¦¬ì ê²€í†  â†’ ìŠ¹ì¸/ê±°ì ˆ                                â”‚
â”‚      â†“                                                      â”‚
â”‚  6ï¸âƒ£  ìŠ¹ì¸ ì‹œ:                                              â”‚
â”‚      - ëŒ€ìƒ ì‚¬ìš©ìì—ê²Œ ì´ë©”ì¼ ë°œì†¡                           â”‚
â”‚      - project_membersì— ì¶”ê°€                               â”‚
â”‚      - ì‚¬ìš©ì Aì—ê²Œ ìŠ¹ì¸ ì•Œë¦¼                                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì‚¬ìš©ì UI:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¥ í”„ë¡œì íŠ¸ ê³µìœ                                       [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ“§ ì´ë©”ì¼: [                          ]                    â”‚
â”‚                                                             â”‚
â”‚  ğŸ” ê¶Œí•œ:  â—‰ ì—´ëŒì (ì¡°íšŒë§Œ)                                â”‚
â”‚           â—‹ í¸ì§‘ì (ë°ì´í„° ìˆ˜ì • ê°€ëŠ¥)                       â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ í˜‘ì—… ê¸°ëŠ¥ì€ ê´€ë¦¬ì ìŠ¹ì¸ í›„ í™œì„±í™”ë©ë‹ˆë‹¤.                 â”‚
â”‚                                                             â”‚
â”‚                              [ì·¨ì†Œ]  [ê³µìœ  ìš”ì²­]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ê´€ë¦¬ì UI (Admin Dashboard):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‹ í˜‘ì—… ìš”ì²­ ê´€ë¦¬                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ”” ëŒ€ê¸° ì¤‘ì¸ ìš”ì²­: 3ê±´                                     â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ìš”ì²­ì: user@company.com                              â”‚ â”‚
â”‚  â”‚ í”„ë¡œì íŠ¸: "ë³¸ì‚¬ 2025ë…„ ë°°ì¶œëŸ‰"                         â”‚ â”‚
â”‚  â”‚ ì´ˆëŒ€ ëŒ€ìƒ: team@company.com                           â”‚ â”‚
â”‚  â”‚ ìš”ì²­ ê¶Œí•œ: í¸ì§‘ì                                     â”‚ â”‚
â”‚  â”‚ ìš”ì²­ì¼: 2025-12-28 15:30                              â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚                           [ê±°ì ˆ]  [âœ… ìŠ¹ì¸]           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“… êµ¬í˜„ ì¼ì • (ì˜ˆìƒ)

```
Week 1 (Phase 1 + 2.1)
â”œâ”€â”€ Day 1-2: ìë™ì €ì¥ + ë²„íŠ¼ ë¼ë²¨ ë³€ê²½
â”œâ”€â”€ Day 3-4: ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
â””â”€â”€ Day 5: ì €ì¥ ìƒíƒœ í‘œì‹œ

Week 2 (Phase 2.2 + Phase 3)
â”œâ”€â”€ Day 1-2: ì—‘ì…€ ì—…ë¡œë“œ/í…œí”Œë¦¿
â”œâ”€â”€ Day 3-4: ë²„ì „ ê´€ë¦¬
â””â”€â”€ Day 5: í˜‘ì—… ê¸°ëŠ¥

Week 3 (í…ŒìŠ¤íŠ¸ ë° ë³´ì™„)
â”œâ”€â”€ Day 1-2: í†µí•© í…ŒìŠ¤íŠ¸
â”œâ”€â”€ Day 3: ë²„ê·¸ ìˆ˜ì •
â””â”€â”€ Day 4-5: ë¬¸ì„œí™” ë° ë°°í¬
```

---

## ğŸ—‚ï¸ íŒŒì¼ êµ¬ì¡° ë³€ê²½ ì˜ˆìƒ

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ actions/
â”‚   â”‚   â”œâ”€â”€ project.ts          # ê¸°ì¡´ (ìˆ˜ì •)
â”‚   â”‚   â”œâ”€â”€ versions.ts         # ì‹ ê·œ
â”‚   â”‚   â””â”€â”€ collaboration.ts    # ì‹ ê·œ
â”‚   â””â”€â”€ admin/
â”‚       â””â”€â”€ collaboration/      # ì‹ ê·œ (ê´€ë¦¬ì í˜‘ì—… ê´€ë¦¬ í˜ì´ì§€)
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ MainCalculator.tsx      # ìˆ˜ì • (ìë™ì €ì¥ ë¡œì§)
â”‚   â”œâ”€â”€ SaveStatusIndicator.tsx # ì‹ ê·œ
â”‚   â”œâ”€â”€ ExportButton.tsx        # ì‹ ê·œ
â”‚   â”œâ”€â”€ ExcelUploadModal.tsx    # ì‹ ê·œ
â”‚   â”œâ”€â”€ VersionHistoryModal.tsx # ì‹ ê·œ
â”‚   â””â”€â”€ CollaborationModal.tsx  # ì‹ ê·œ
â”‚
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ excelExport.ts          # ì‹ ê·œ
â”‚   â”œâ”€â”€ excelImport.ts          # ì‹ ê·œ
â”‚   â””â”€â”€ debounce.ts             # ì‹ ê·œ
â”‚
â”œâ”€â”€ translations/
â”‚   â””â”€â”€ main.ts                 # ìˆ˜ì • (ìƒˆ ë²ˆì—­ í‚¤ ì¶”ê°€)
â”‚
â””â”€â”€ public/
    â””â”€â”€ templates/
        â””â”€â”€ GHG_Input_Template.xlsx  # ì‹ ê·œ
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### Phase 1: í•µì‹¬ ì €ì¥ ê¸°ëŠ¥
- [ ] 1.1 ìë™ì €ì¥ (ë¡œê·¸ì¸ ì‚¬ìš©ì)
  - [ ] debounce ìœ í‹¸ë¦¬í‹° êµ¬í˜„
  - [ ] useEffectë¡œ ìë™ ì €ì¥ íŠ¸ë¦¬ê±°
  - [ ] ì €ì¥ ìƒíƒœ state ì¶”ê°€
- [ ] 1.2 ë²„íŠ¼ ë¼ë²¨ ë³€ê²½
  - [ ] ë²ˆì—­ íŒŒì¼ ìˆ˜ì •
  - [ ] ì»´í¬ë„ŒíŠ¸ í…ìŠ¤íŠ¸ ë³€ê²½
- [ ] 1.3 ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
  - [ ] xlsx íŒ¨í‚¤ì§€ ì„¤ì¹˜
  - [ ] excelExport ìœ í‹¸ë¦¬í‹° êµ¬í˜„
  - [ ] ExportButton ì»´í¬ë„ŒíŠ¸ ìƒì„±
  - [ ] MainCalculatorì— ë²„íŠ¼ ì¶”ê°€

### Phase 2: UX ê°œì„ 
- [ ] 2.1 ì €ì¥ ìƒíƒœ í‘œì‹œ
  - [ ] SaveStatusIndicator ì»´í¬ë„ŒíŠ¸ ìƒì„±
  - [ ] ì˜¨ë¼ì¸/ì˜¤í”„ë¼ì¸ ê°ì§€ ë¡œì§
  - [ ] Header ë˜ëŠ” MainCalculatorì— ë°°ì¹˜
- [ ] 2.2 ì—‘ì…€ ì—…ë¡œë“œ/í…œí”Œë¦¿
  - [ ] í…œí”Œë¦¿ ì—‘ì…€ íŒŒì¼ ìƒì„±
  - [ ] excelImport ìœ í‹¸ë¦¬í‹° êµ¬í˜„
  - [ ] ExcelUploadModal ì»´í¬ë„ŒíŠ¸ ìƒì„±
  - [ ] ë°ì´í„° ê²€ì¦ ë¡œì§ êµ¬í˜„

### Phase 3: ê³ ê¸‰ ê¸°ëŠ¥
- [ ] 3.1 ë²„ì „ ê´€ë¦¬
  - [ ] DB ìŠ¤í‚¤ë§ˆ ì¶”ê°€ (project_versions)
  - [ ] Server Actions êµ¬í˜„
  - [ ] VersionHistoryModal ì»´í¬ë„ŒíŠ¸ ìƒì„±
- [ ] 3.2 í˜‘ì—… ê¸°ëŠ¥
  - [ ] DB ìŠ¤í‚¤ë§ˆ ì¶”ê°€ (project_members, collaboration_requests)
  - [ ] Server Actions êµ¬í˜„
  - [ ] CollaborationModal ì»´í¬ë„ŒíŠ¸ ìƒì„±
  - [ ] Admin í˜‘ì—… ìš”ì²­ ê´€ë¦¬ í˜ì´ì§€ ìƒì„±

---

## ğŸ“ ì°¸ê³ ì‚¬í•­

1. **ìë™ ì €ì¥ debounce ì‹œê°„**: 2ì´ˆ ê¶Œì¥ (ë„ˆë¬´ ì§§ìœ¼ë©´ API ê³¼ë¶€í•˜, ë„ˆë¬´ ê¸¸ë©´ UX ì €í•˜)
2. **ë²„ì „ ê´€ë¦¬ ë³´ê´€ ì •ì±…**: ìŠ¤í† ë¦¬ì§€ ë¹„ìš© ê³ ë ¤í•˜ì—¬ ìµœì‹  20ê°œ ê¶Œì¥
3. **í˜‘ì—… ê¸°ëŠ¥**: ì´ˆê¸°ì—ëŠ” ê´€ë¦¬ì ìˆ˜ë™ ìŠ¹ì¸, ì¶”í›„ ìë™í™” ê°€ëŠ¥
4. **ì—‘ì…€ ë¼ì´ë¸ŒëŸ¬ë¦¬**: `xlsx` (SheetJS) ì¶”ì²œ - ë¬´ë£Œ, ë„ë¦¬ ì‚¬ìš©ë¨

---

> âš ï¸ **ì¤‘ìš”**: ì´ ê³„íšì€ ìŠ¹ì¸ í›„ êµ¬í˜„ë©ë‹ˆë‹¤. ë³€ê²½ì´ í•„ìš”í•œ ë¶€ë¶„ì´ ìˆìœ¼ë©´ ë§ì”€í•´ ì£¼ì„¸ìš”!
