# 카테고리 5 (사업장 발생 폐기물) 개선 구현 계획

## 📋 개요

NIER Scope 3 가이드라인 및 GHG Protocol Technical Guidance를 기반으로 카테고리 5를 개선합니다. 기존 카테고리 1-3의 패턴(DQI 섹션, Methodology Wizard 등)을 적용하여 일관성을 유지합니다.

---

## 🎯 주요 개선 항목

### 1. 산정 방법론 확장 (현재 3개 → 정교화)

| 현재 방법 | 개선된 방법 | 설명 |
|-----------|-------------|------|
| `activity` | `waste_type` | **폐기물 종류 기반**: 폐기물 성상 및 처리방법별 배출계수 적용 |
| `spend` | `spend` | **지출 기반**: 폐기물 관리 서비스 금액 × 원단위 배출계수 |
| `supplier_specific` | `supplier_specific` | **공급원별**: 처리업체 Scope 1,2 배출량 할당 |
| (신규) | `average` | **평균 산정법**: 총 폐기물량 × 국가 통계 비율 × 처리방법별 배출계수 |

### 2. Methodology Wizard 추가

첨부 이미지의 플로우차트를 기반으로 산정법 선택 가이드 구현:
```
Q1: 사업장 발생 폐기물이 전체 Scope 3 배출량에 주요 영향을 미치는가?
├── 예 → Q2: 폐기물 처리업체로부터 Scope 1,2 배출량 확보 가능한가?
│         ├── 예 → 공급원별 산정법
│         └── 아니오 → Q3
└── 아니오 → Q3: 폐기물 종류 및 처리방식별 구분이 가능한가?
              ├── 예 → 폐기물 종류 기반 산정법
              └── 아니오 → 평균 산정법
```

### 3. DQI (데이터 품질 지표) 섹션 추가

카테고리 1-3 패턴에 따라 5가지 품질 지표 입력 UI 추가:
- 기술적 대표성 (Technological)
- 시간적 대표성 (Temporal)
- 지리적 대표성 (Geographical)
- 완결성 (Completeness)
- 신뢰성 (Reliability)

### 4. 배출계수 데이터베이스 확장

PDF의 [표 36], [표 37]을 기반으로 상세 배출계수 추가:

#### 4.1 환경성적표지 평가계수 (KR-LCI)
| 폐기물 종류 | 매립 | 소각 | 재활용 |
|-------------|------|------|--------|
| 일반폐기물 | 0.0064 | 0.0445 | 0.0186 |
| 폐합성수지(PVC 외) | 0.0132 | 3.4126 | 0.0186 |
| 폐목재류 | 2.1195 | 0.7157 | 0.0136 |
| 폐지류 | 1.1711 | 0.5288 | 0.0715 |
| 폐금속류 | 0.0122 | 0.5121 | 0.0038 |
| 음식물류 | 0.4382 | 0.0405 | 0.0112 |
| 폐유리류 | 0.0119 | 0.3727 | 0.0098 |
| 폐콘크리트류 | 0.0122 | 0.2164 | 0.0138 |
| 지정폐기물(폐유) | 0.1775 | 1.7990 | - |

#### 4.2 하·폐수 처리
| 종류 | 배출계수 (kgCO₂e/m³) |
|------|----------------------|
| 산업폐수 | 0.85 |
| 생활하수 | 0.45 |

#### 4.3 냉매/공정가스 (GWP 기반)
| 냉매 | GWP | 처리방법 |
|------|-----|----------|
| R-134a | 1430 | 대기배출/회수 |
| R-410A | 2088 | 대기배출/회수 |
| SF6 | 22800 | 대기배출/회수 |

### 5. UI/UX 개선

#### 5.1 가이던스 박스 업데이트
- 포함/미포함 사항 명확히 표시
- Scope 1,2 경계 경고 강화
- Category 12 경계 경고 (제품 최종 폐기)

#### 5.2 새로운 입력 필드
- **평균 산정법**: 폐기물 처리방식별 비율 입력 (매립 %, 소각 %, 재활용 %)
- **공급원별**: 처리업체 Scope 1,2 배출량 + 할당비율 입력
- **냉매/공정가스**: 별도 탭 또는 섹션으로 분리

#### 5.3 운송 배출량 (선택사항)
- 폐기물 처리업체까지의 운송 배출량 별도 계산 옵션
- 카테고리 4 운송 모듈 재사용

---

## 📁 파일 변경 계획

### [Phase 1] 상수 및 타입 확장

#### [MODIFY] `src/constants/scope3/category5.ts`
- 환경성적표지 평가계수 기반 상세 배출계수 추가
- 하·폐수 처리 배출계수 추가
- 냉매/공정가스 GWP 데이터 추가
- 국가 통계 기반 처리방식별 비율 기본값 추가

#### [MODIFY] `src/types.ts`
- `Cat5CalculationMethod` 타입에 `'average'` 추가
- `WasteType` 확장 (하폐수, 냉매 등)
- `TreatmentMethod` 확장 (혐기성소화, 하폐수처리 등)

### [Phase 2] Methodology Wizard 확장

#### [MODIFY] `src/components/MethodologyWizard.tsx`
- 카테고리 5 전용 질문 플로우 추가 (`q_cat5_1`, `q_cat5_2`, `q_cat5_3`)
- 결과에 `waste_type`, `average`, `supplier_specific` 매핑
- 카테고리 5 전용 결과 설명 및 필요 데이터 정의

### [Phase 3] UI 컴포넌트 개선

#### [MODIFY] `src/components/source_rows/Category5Row.tsx`
- **DQI 섹션** 추가 (`<DQISection />` 컴포넌트 통합)
- **Methodology Wizard 버튼** 추가
- **평균 산정법 UI**: 처리방식별 비율 입력 + 자동 계산
- **공급원별 UI**: 처리업체 배출량 + 할당비율 입력
- **가이던스 박스 업데이트**: PDF 기반 상세 안내
- **운송 배출량 섹션** 개선

### [Phase 4] 번역 및 가이드 텍스트

#### [MODIFY] `src/translations/ko.ts`, `src/translations/en.ts`
- 새로운 산정법 관련 번역 키 추가
- 가이던스 텍스트 업데이트
- DQI 관련 번역 추가

---

## ✅ 검증 계획

### 기능 테스트
1. **Methodology Wizard**: 플로우차트대로 질문에 답하면 올바른 산정법이 선택되는지 확인
2. **배출계수 적용**: 폐기물 종류/처리방법 선택 시 올바른 배출계수가 적용되는지 확인
3. **평균 산정법**: 비율 입력 시 자동 계산이 올바르게 수행되는지 확인
4. **공급원별**: 처리업체 배출량 × 할당비율 계산 검증
5. **DQI**: 점수 계산 및 등급 표시 정확성 확인

### 산정 사례 검증 (PDF 예제)
- **폐기방식 기반 예제**: 사업장 일반폐기물 1,000톤 + 지정폐기물 500톤 → 1,740 tCO₂e
- **평균값 기반 예제**: 대형마트 폐기물 2,000톤 → 2,021 tCO₂e
- **공급원별 예제**: 재활용업체 D사 + 소각업체 E사 → 5,940 tCO₂e

---

## 📊 예상 작업량

| Phase | 작업 내용 | 예상 시간 |
|-------|----------|----------|
| Phase 1 | 상수/타입 확장 | 30분 |
| Phase 2 | Methodology Wizard | 20분 |
| Phase 3 | UI 컴포넌트 개선 | 60분 |
| Phase 4 | 번역 추가 | 20분 |
| 검증 | 테스트 및 수정 | 30분 |
| **총계** | | **~2.5시간** |

---

## ⚠️ 주의사항

1. **중복 산정 회피**: 재활용 폐기물이 카테고리 1(원자재)과 카테고리 5에서 중복 산정되지 않도록 가이던스 제공
2. **Scope 1,2 경계**: 자사 소유 폐기물 처리시설은 Scope 1,2로 보고 (카테고리 5 제외)
3. **Category 12 경계**: 판매된 제품의 최종 폐기는 카테고리 12로 보고

---

## 📝 사용자 확인 필요 사항

이 계획을 검토하시고 다음 사항에 대해 피드백 부탁드립니다:

1. **우선순위**: 모든 Phase를 순서대로 진행할까요, 아니면 특정 기능을 먼저 구현할까요?
2. **냉매/공정가스**: 별도 탭으로 분리할까요, 아니면 기존 UI에 통합할까요?
3. **운송 배출량**: 필수 기능으로 할까요, 선택 사항으로 유지할까요?
